Raonament:
1. **Understanding the rules:** The grid must contain the numbers 1 to 5 exactly once in each row and column.  The sum of numbers in the three areas defined by the thick lines must be equal.
2. **Calculate the sums:** The sum of the numbers from 1 to 5 is 1 + 2 + 3 + 4 + 5 = 15. Since each number should be exactly once in each row and each column, the totals of each of the three defined areas, as well as rows and columns should be the same.
3. **Deduce the area sums:** The total sum is 15. We have three areas, and the sums of the areas are the same. The total of each are has to be 15. The sum is 15 / 3 = 5, that means the three regions should result in a total of 15.
4. **Determine the missing number:**  Looking at the areas defined by the thick lines, we have the number 2 in one of them.
5. **Filling the grid:** The area which contains the 2, contains also a row and column.  Each number appears once on both row and column.
6. **Find the missing number:**  In the upper right corner, given the structure, the only number that makes the area calculation and row and column constraints consistent is 4. The area containing the 2 sums to 2+1+3+4+5 = 15. That means the top right corner has to be 4 to match the rule.
Resposta: D)
